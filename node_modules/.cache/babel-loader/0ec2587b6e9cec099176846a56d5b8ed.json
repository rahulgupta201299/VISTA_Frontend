{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\Web_Page\\\\vista\\\\Frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\Web_Page\\\\vista\\\\Frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\Web_Page\\\\vista\\\\Frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import'./Signin.scss';import{Button}from'../new_Button/new_Button';import{withRouter}from'react-router-dom';import FormInput from'../FormInput/FormInput';import{createDB,setCurrentUser}from'../redux/user/user-actions';import{setVerify,setError,setUser,setID,setTimeOut}from'../redux/userError/userError-actions';//import {signInWithGoogle} from '../Firebase/FirebaseSTUD'\nimport{auth,createUserProfileDocument,firestore}from'../Firebase/FirebaseSTUD';import firebase from'../Firebase/FirebaseSTUD';import{connect}from'react-redux';import swal from'sweetalert';//import OtpInput from 'react-otp-input';\nfunction Signin(_ref){var currentUser=_ref.currentUser,currentVer=_ref.currentVer,dispatch=_ref.dispatch,history=_ref.history,currentErr=_ref.currentErr;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),disable=_useState2[0],setDisable=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),err=_useState4[0],setErr=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),verify=_useState6[0],IsVerified=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),email=_useState8[0],setEmail=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),Fname=_useState10[0],setFname=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),Lname=_useState12[0],setLname=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),state=_useState14[0],setState=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),pin=_useState16[0],Setpin=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),teach=_useState18[0],setTeach=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),btn=_useState20[0],setButton=_useState20[1];var _useState21=useState(true),_useState22=_slicedToArray(_useState21,2),stud=_useState22[0],setStud=_useState22[1];var _useState23=useState(''),_useState24=_slicedToArray(_useState23,2),password=_useState24[0],setPassword=_useState24[1];var _useState25=useState(true),_useState26=_slicedToArray(_useState25,2),login=_useState26[0],setLogin=_useState26[1];var _useState27=useState(''),_useState28=_slicedToArray(_useState27,2),phone=_useState28[0],setPhone=_useState28[1];var _useState29=useState(false),_useState30=_slicedToArray(_useState29,2),signup=_useState30[0],setSignup=_useState30[1];var _useState31=useState(''),_useState32=_slicedToArray(_useState31,2),grade=_useState32[0],setGrade=_useState32[1];var color1=login?\"green\":\"blue\";var color2=signup?\"green\":\"blue\";var showButton=function showButton(){if(window.innerWidth<=960){setButton(true);}else{setButton(false);}};var handleToggle1=function handleToggle1(){setTeach(true);setStud(false);};var handleToggle2=function handleToggle2(){setStud(true);setTeach(false);};var handleToggle3=function handleToggle3(){setLogin(true);setSignup(false);};var handleToggle4=function handleToggle4(){setLogin(false);setSignup(true);};function signInWithGoogle(){return _signInWithGoogle.apply(this,arguments);}function _signInWithGoogle(){_signInWithGoogle=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var username,provider,z,flag;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(stud)username=\"StudentUsers\";if(teach)username=\"TeacherUsers\";provider=new firebase.auth.GoogleAuthProvider();provider.setCustomParameters({prompt:'select_account'});dispatch(setUser(username));_context.next=7;return auth.signInWithPopup(provider);case 7:z=auth.currentUser;flag=0;firestore.collection(\"\".concat(username)).get().then(function(query){query.forEach(function(doc){if(z.email===doc.data().email){flag=1;dispatch(setID(doc.id));}});if(flag){history.push(\"/\");window.location.reload();}else{setErr('You may be login with diff user (Student/Teacher) or maybe you are not registered');auth.signOut();}});case 10:case\"end\":return _context.stop();}}},_callee);}));return _signInWithGoogle.apply(this,arguments);}var handlePhone=function handlePhone(e){var num=e.target.value;setPhone(num);if(num.match(/^(\\+\\d{1,3}[- ]?)?\\d{10}$/)&&num.length===10){setDisable(false);setErr('');}else{setDisable(true);setErr(\"Invalid Phone Number\");}};var setUpRecaptcha=function setUpRecaptcha(){window.recaptchaVerifier=new firebase.auth.RecaptchaVerifier('recaptcha',{'size':'invisible','callback':function callback(response){// reCAPTCHA solved, allow signInWithPhoneNumber.\nhandleOTP();},'expired-callback':function expiredCallback(){setErr(\"Response expired. Please solve reCAPTCHA again.\");}});};var handleOTP=function handleOTP(e){e.preventDefault();if(!phone.match(/^(\\+\\d{1,3}[- ]?)?\\d{10}$/)){return;}setDisable(true);setUpRecaptcha();setErr(\"Please Enter OTP Coming As Prompt!\");var phoneNumber=\"+91\"+phone;var appVerifier=window.recaptchaVerifier;auth.signInWithPhoneNumber(phoneNumber,appVerifier).then(function(confirmationResult){// SMS sent. Prompt user to type the code from the message, then sign the\n// user in with confirmationResult.confirm(code).\nwindow.confirmationResult=confirmationResult;var code=window.prompt(\"Enter the OTP\");confirmationResult.confirm(code).then(function(result){// User signed in successfully.\nvar user=result.user;if(user){swal({title:\"OTP Verified!\",text:\"You mobile no. is verified! Proceed further and fill all remaining details!\",icon:\"success\"});setErr(\"\");IsVerified(true);}}).catch(function(error){// User couldn't sign in (bad verification code?)\n// ...\nswal({title:\"Not Verified\",text:\"Incorrect or Bad Verification Code\",icon:\"warning\"}).then(function(res1){window.location.reload();});setErr(error.message+\" Reload and Try Again\");});}).catch(function(error){// Error; SMS not sent\n// ...\nswal({title:\"Some error Occured. Try Again Later!\",text:\"SMS not sent. Retry!\",icon:\"warning\",confirmButtonClass:\"btn-danger\",confirmButtonText:\"Retry\"}).then(function(res1){window.location.reload();});setErr(error.message+\" Reload and Try Again\");});};function handleResetPassword(_x){return _handleResetPassword.apply(this,arguments);}function _handleResetPassword(){_handleResetPassword=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var x,user;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();x=window.prompt(\"Enter your existing Email Id\");if(!x){_context2.next=13;break;}_context2.prev=3;_context2.next=6;return auth.fetchSignInMethodsForEmail(x);case 6:user=_context2.sent;if(user.length===0){setErr('Please register! Your email is not registered or please enter the existing Email');}else{auth.sendPasswordResetEmail(x);setErr(\"Reset password link has been sent to your email!\");}_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](3);setErr(_context2.t0.message);case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[3,10]]);}));return _handleResetPassword.apply(this,arguments);}function handleLogin(_x2){return _handleLogin.apply(this,arguments);}function _handleLogin(){_handleLogin=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var username,z,userRef,snapShot;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:e.preventDefault();_context3.prev=1;if(stud)username=\"StudentUsers\";if(teach)username=\"TeacherUsers\";dispatch(setUser(username));_context3.next=7;return auth.signInWithEmailAndPassword(email,password);case 7:z=auth.currentUser;userRef=firestore.doc(\"\".concat(username,\"/\").concat(z.uid));_context3.next=11;return userRef.get();case 11:snapShot=_context3.sent;if(!snapShot.exists){dispatch(setVerify(false));setErr('You are trying to get login as different user (Student/Teacher)');auth.signOut();//window.location.reload()\n}else{if(z.emailVerified){dispatch(setID(z.uid));history.push(\"/\");setErr(\"\");window.location.reload();}else{dispatch(setVerify(true));z.sendEmailVerification();setErr('Please Verify the mail and Log In!');}}_context3.next=19;break;case 15:_context3.prev=15;_context3.t0=_context3[\"catch\"](1);setErr(_context3.t0.message);console.log(_context3.t0.message);case 19:case\"end\":return _context3.stop();}}},_callee3,null,[[1,15]]);}));return _handleLogin.apply(this,arguments);}function handleRegister(_x3){return _handleRegister.apply(this,arguments);}function _handleRegister(){_handleRegister=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e){var username,_yield$auth$createUse,user,displayName;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:e.preventDefault();if(verify){_context4.next=4;break;}setErr(\"Please verify the PhoneNumber\");return _context4.abrupt(\"return\");case 4:if(!(grade==='')){_context4.next=7;break;}setErr('Please provide your Grade and then Register!');return _context4.abrupt(\"return\");case 7:if(!(state===\"\")){_context4.next=10;break;}setErr(\"Please provide your State and then Register\");return _context4.abrupt(\"return\");case 10:_context4.prev=10;if(stud){username=\"StudentUsers\";}if(teach){username=\"TeacherUsers\";}_context4.next=15;return auth.createUserWithEmailAndPassword(email,password);case 15:_yield$auth$createUse=_context4.sent;user=_yield$auth$createUse.user;displayName=Fname+\" \"+Lname;displayName=displayName.toUpperCase();createUserProfileDocument(user,username,{displayName:displayName,grade:grade,phone:phone,state:state,pin:pin});setLogin(true);setSignup(false);setErr('');_context4.next=29;break;case 25:_context4.prev=25;_context4.t0=_context4[\"catch\"](10);setErr(_context4.t0.message);console.log(_context4.t0.message);case 29:case\"end\":return _context4.stop();}}},_callee4,null,[[10,25]]);}));return _handleRegister.apply(this,arguments);}var data=[\"Andhra Pradesh\",\"Arunachal Pradesh\",\"Assam\",\"Bihar\",\"Chhattisgarh\",\"Goa\",\"Gujarat\",\"Haryana\",\"Himachal Pradesh\",\"Jharkhand\",\"Karnataka\",\"Kerala\",\"Madhya Pradesh\",\"Maharashtra\",\"Manipur\",\"Meghalaya\",\"Mizoram\",\"Nagaland\",\"Odisha\",\"Punjab\",\"Rajasthan\",\"Sikkim\",\"Tamil Nadu\",\"Telangana\",\"Tripura\",\"Uttar Pradesh\",\"Uttarakhand\",\"West Bengal\",\"Andaman and Nicobar\",\"Chandigarh\",\"Daman and Diu\",\"Dadar and Nagar Haveli\",\"Delhi\",\"Jammu and Kashmir\",\"Ladakh\",\"Lakshadweep\",\"Puducherry\"];data.sort();data=data.map(function(item){return item.toUpperCase();});useEffect(function(){showButton();window.addEventListener('resize',showButton);},[]);var change=btn?\"34%\":\"38%\";return/*#__PURE__*/React.createElement(\"div\",{className:\"initial\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"section\",{className:\"toggle-container\"},/*#__PURE__*/React.createElement(Button,{buttonStyle:\"btn--outline\",buttonSize:btn?\"btn-medium\":\"btn--wide\",buttonColor:teach?\"green\":\"blue\",onClick:handleToggle1},\"Teacher\"),/*#__PURE__*/React.createElement(Button,{buttonStyle:\"btn--outline\",buttonSize:btn?\"btn-medium\":\"btn--wide\",buttonColor:stud?\"green\":\"blue\",onClick:handleToggle2},\"Student\")),/*#__PURE__*/React.createElement(\"section\",{className:\"form-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"toggle\"},/*#__PURE__*/React.createElement(\"button\",{className:\"signin \".concat(color1),onClick:handleToggle3},\"Sign In\"),/*#__PURE__*/React.createElement(\"button\",{className:\"signin \".concat(color2),onClick:handleToggle4},\"Sign Up\")),login?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"p\",{style:{color:\"green\",marginLeft:\"28%\",marginTop:\"5px\"}},\"Login As a \",stud?\"Student\":\"Teacher\"),currentVer?/*#__PURE__*/React.createElement(\"p\",{style:{color:\"green\",margin:\"7px\"}},\"Please Verify Your Email And Log In Again (Link Has Been Sent)!\"):null,currentUser?/*#__PURE__*/React.createElement(\"p\",{style:{color:\"green\",marginLeft:\"35%\",marginTop:\"5px\"}},\"You are Logged In!\"):null,err?/*#__PURE__*/React.createElement(\"p\",{style:{color:\"red\",margin:\"7px\"}},err):\"\",/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleLogin},/*#__PURE__*/React.createElement(FormInput,{type:\"text\",value:email,onChange:function onChange(e){return setEmail(e.target.value);},placeholder:\"Email\",required:true}),/*#__PURE__*/React.createElement(FormInput,{type:\"password\",value:password,onChange:function onChange(e){return setPassword(e.target.value);},placeholder:\"Password\",required:true}),/*#__PURE__*/React.createElement(\"span\",{style:{marginLeft:change}},/*#__PURE__*/React.createElement(Button,{type:\"submit\",buttonStyle:\"btn--primary\",buttonColor:\"green\",buttonSize:btn?\"btn--mobile\":\"btn--medium\"},\"Login\"))),/*#__PURE__*/React.createElement(\"button\",{className:\"reset\",onClick:handleResetPassword},\"Reset Password\"),/*#__PURE__*/React.createElement(\"span\",{style:{marginLeft:\"44%\",fontWeight:\"bold\",color:\"black\"}},\"Or\"),/*#__PURE__*/React.createElement(\"button\",{className:\"signinwithGoogle\",onClick:signInWithGoogle},\"Sign In With Google\")):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"p\",{style:{color:\"green\",marginLeft:\"28%\",marginTop:\"5px\"}},\"Register As a \",stud?\"Student\":\"Teacher\"),err?/*#__PURE__*/React.createElement(\"p\",{style:{color:\"red\",margin:\"7px\"}},err):\"\",/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleRegister},/*#__PURE__*/React.createElement(FormInput,{type:\"text\",value:Fname,onChange:function onChange(e){return setFname(e.target.value);},placeholder:\"First Name\",required:true}),/*#__PURE__*/React.createElement(FormInput,{type:\"text\",value:Lname,onChange:function onChange(e){return setLname(e.target.value);},placeholder:\"Last Name\",required:true}),/*#__PURE__*/React.createElement(\"select\",{className:\"select\",onChange:function onChange(e){return setGrade(e.target.value);}},/*#__PURE__*/React.createElement(\"option\",{value:\"\"},\"Grade\"),/*#__PURE__*/React.createElement(\"option\",{value:\"7\"},\"7\"),/*#__PURE__*/React.createElement(\"option\",{value:\"8\"},\"8\"),/*#__PURE__*/React.createElement(\"option\",{class:\"9\"},\"9\"),/*#__PURE__*/React.createElement(\"option\",{value:\"10\"},\"10\")),/*#__PURE__*/React.createElement(FormInput,{type:\"email\",value:email,onChange:function onChange(e){return setEmail(e.target.value);},placeholder:\"Email\",required:true}),verify?/*#__PURE__*/React.createElement(FormInput,{type:\"phone\",value:phone,onChange:handlePhone,placeholder:\"Phone No.\",disabled:true,required:true}):/*#__PURE__*/React.createElement(FormInput,{type:\"phone\",value:phone,onChange:handlePhone,placeholder:\"Phone No.\",required:true}),verify?/*#__PURE__*/React.createElement(\"p\",{style:{marginLeft:\"18%\",color:\"green\"}},\"PhoneNumber is Verified\"):/*#__PURE__*/React.createElement(Button,{point:disable,id:\"recaptcha\",buttonStyle:\"btn--primary\",buttonColor:\"blue\",buttonSize:\"btn--medium\",onClick:handleOTP},\"Get OTP\"),/*#__PURE__*/React.createElement(\"select\",{className:\"select\",style:{backgroundColor:\"white\"},onChange:function onChange(e){return setState(e.target.value);}},/*#__PURE__*/React.createElement(\"option\",{value:\"\"},\"State/Union Territory\"),data.map(function(item,i){return/*#__PURE__*/React.createElement(\"option\",{key:i,value:item},item);})),/*#__PURE__*/React.createElement(FormInput,{type:\"number\",value:pin,onChange:function onChange(e){return Setpin(e.target.value);},placeholder:\"PIN Code\",required:true}),/*#__PURE__*/React.createElement(FormInput,{type:\"password\",value:password,onChange:function onChange(e){return setPassword(e.target.value);},placeholder:\"Password\",required:true}),/*#__PURE__*/React.createElement(\"span\",{style:{marginLeft:change}},/*#__PURE__*/React.createElement(Button,{type:\"submit\",buttonStyle:\"btn--primary\",buttonColor:\"green\",buttonSize:btn?\"btn--mobile\":\"btn--medium\"},\"Register\")))))));}var mapStateToProps=function mapStateToProps(state){return{currentUser:state.user.currentUser,currentVer:state.userError.currentVer,currentErr:state.userError.error};};export default withRouter(connect(mapStateToProps,null)(Signin));/*\r\n\r\n\r\n        var x= await fetch(\"http://127.0.0.1:8000/api/register/\",{\r\n            method: \"POST\",\r\n            body: JSON.stringify(data),\r\n            headers:{\r\n                'Content-type': 'application/json; charset=UTF-8',\r\n            },\r\n        }).then((res)=>{\r\n            if(res.ok){\r\n                console.log(res.json())\r\n            }\r\n            else{\r\n                res.json().then(err=>console.log(err.Error))\r\n            }\r\n        })\r\n\r\n\r\n\r\n        \r\n\r\n*/","map":{"version":3,"sources":["D:/Web_Page/vista/Frontend/src/my_components/Signin/Signin.js"],"names":["React","useState","useEffect","Button","withRouter","FormInput","createDB","setCurrentUser","setVerify","setError","setUser","setID","setTimeOut","auth","createUserProfileDocument","firestore","firebase","connect","swal","Signin","currentUser","currentVer","dispatch","history","currentErr","disable","setDisable","err","setErr","verify","IsVerified","email","setEmail","Fname","setFname","Lname","setLname","state","setState","pin","Setpin","teach","setTeach","btn","setButton","stud","setStud","password","setPassword","login","setLogin","phone","setPhone","signup","setSignup","grade","setGrade","color1","color2","showButton","window","innerWidth","handleToggle1","handleToggle2","handleToggle3","handleToggle4","signInWithGoogle","username","provider","GoogleAuthProvider","setCustomParameters","prompt","signInWithPopup","z","flag","collection","get","then","query","forEach","doc","data","id","push","location","reload","signOut","handlePhone","e","num","target","value","match","length","setUpRecaptcha","recaptchaVerifier","RecaptchaVerifier","response","handleOTP","preventDefault","phoneNumber","appVerifier","signInWithPhoneNumber","confirmationResult","code","confirm","result","user","title","text","icon","catch","error","res1","message","confirmButtonClass","confirmButtonText","handleResetPassword","x","fetchSignInMethodsForEmail","sendPasswordResetEmail","handleLogin","signInWithEmailAndPassword","userRef","uid","snapShot","exists","emailVerified","sendEmailVerification","console","log","handleRegister","createUserWithEmailAndPassword","displayName","toUpperCase","sort","map","item","addEventListener","change","color","marginLeft","marginTop","margin","fontWeight","backgroundColor","i","mapStateToProps","userError"],"mappings":"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","sourcesContent":["import React,{useState,useEffect} from 'react'\r\nimport './Signin.scss'\r\nimport {Button} from '../new_Button/new_Button'\r\nimport {withRouter} from 'react-router-dom'\r\nimport FormInput from '../FormInput/FormInput'\r\nimport {createDB,setCurrentUser} from '../redux/user/user-actions'\r\nimport {setVerify,setError,setUser,setID,setTimeOut} from '../redux/userError/userError-actions'\r\n//import {signInWithGoogle} from '../Firebase/FirebaseSTUD'\r\nimport { auth, createUserProfileDocument,firestore } from '../Firebase/FirebaseSTUD'\r\nimport firebase from '../Firebase/FirebaseSTUD'\r\nimport { connect } from 'react-redux'\r\nimport swal from 'sweetalert'\r\n//import OtpInput from 'react-otp-input';\r\n\r\nfunction Signin({currentUser,currentVer,dispatch,history,currentErr}) {\r\n    const [disable,setDisable]=useState(true)\r\n    const [err,setErr]=useState('')\r\n    const [verify,IsVerified]=useState(false)\r\n    const [email,setEmail]=useState('')\r\n    const [Fname,setFname]=useState('')\r\n    const [Lname,setLname]=useState('')\r\n    const [state,setState]=useState('')\r\n    const [pin,Setpin]=useState('')\r\n    const [teach,setTeach]=useState(false)\r\n    const [btn,setButton]=useState(false)\r\n    const [stud,setStud]=useState(true)\r\n    const [password,setPassword]=useState('')\r\n    const [login,setLogin]=useState(true)\r\n    const [phone,setPhone]=useState('')\r\n    const [signup,setSignup]=useState(false)\r\n    const [grade,setGrade]=useState('')\r\n    const color1=login?\"green\":\"blue\"\r\n    const color2=signup?\"green\":\"blue\"\r\n    const showButton = () => {\r\n        if (window.innerWidth <= 960) {\r\n          setButton(true);\r\n        } else {\r\n          setButton(false);\r\n        }\r\n      };\r\n      \r\n    const handleToggle1=()=>{\r\n        setTeach(true)\r\n        setStud(false)\r\n    }\r\n    const handleToggle2=()=>{\r\n        setStud(true)\r\n        setTeach(false)\r\n    }\r\n    const handleToggle3=()=>{\r\n        setLogin(true)\r\n        setSignup(false)\r\n    }\r\n    const handleToggle4=()=>{\r\n        setLogin(false)\r\n        setSignup(true)\r\n    }\r\n    async function signInWithGoogle(){\r\n        var username;\r\n        if(stud) username=\"StudentUsers\"\r\n        if(teach) username=\"TeacherUsers\"\r\n        const provider=new firebase.auth.GoogleAuthProvider()\r\n        provider.setCustomParameters({prompt: 'select_account'})\r\n        dispatch(setUser(username))\r\n        await auth.signInWithPopup(provider)\r\n        var z=auth.currentUser\r\n        var flag=0;\r\n        firestore.collection(`${username}`).get().then(query=>{\r\n            query.forEach((doc) => {\r\n                if(z.email===doc.data().email){\r\n                    flag=1;\r\n                    dispatch(setID(doc.id))\r\n                }\r\n            });\r\n            if(flag){\r\n                history.push(\"/\")\r\n                window.location.reload()\r\n            }\r\n            else{\r\n                setErr('You may be login with diff user (Student/Teacher) or maybe you are not registered')\r\n                auth.signOut()\r\n            }\r\n        })\r\n        \r\n    }\r\n    const handlePhone=(e)=>{\r\n        var num=e.target.value;\r\n        setPhone(num)\r\n        if(num.match(/^(\\+\\d{1,3}[- ]?)?\\d{10}$/)&&num.length===10){\r\n            setDisable(false)\r\n            setErr('')\r\n        }\r\n        else{\r\n            setDisable(true)\r\n            setErr(\"Invalid Phone Number\")\r\n        }\r\n    }\r\n    const setUpRecaptcha=()=>{\r\n        window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha', {\r\n            'size': 'invisible',\r\n            'callback': function(response) {\r\n              // reCAPTCHA solved, allow signInWithPhoneNumber.\r\n              handleOTP();\r\n            },\r\n            'expired-callback':()=>{\r\n                setErr(\"Response expired. Please solve reCAPTCHA again.\")\r\n            }\r\n          });\r\n       }\r\n    const handleOTP=(e)=>{\r\n        e.preventDefault()\r\n        if(!phone.match(/^(\\+\\d{1,3}[- ]?)?\\d{10}$/)){\r\n            return;\r\n        }\r\n        setDisable(true)\r\n        setUpRecaptcha()\r\n        setErr(\"Please Enter OTP Coming As Prompt!\")\r\n        var phoneNumber = \"+91\"+phone\r\n        var appVerifier = window.recaptchaVerifier;\r\n        auth.signInWithPhoneNumber(phoneNumber, appVerifier)\r\n            .then(function (confirmationResult) {\r\n              // SMS sent. Prompt user to type the code from the message, then sign the\r\n              // user in with confirmationResult.confirm(code).\r\n              window.confirmationResult = confirmationResult;\r\n                var code = window.prompt(\"Enter the OTP\")\r\n                confirmationResult.confirm(code).then(function (result) {\r\n                // User signed in successfully.\r\n                var user = result.user;\r\n                if(user){\r\n                    swal({\r\n                        title: \"OTP Verified!\",\r\n                        text: \"You mobile no. is verified! Proceed further and fill all remaining details!\",\r\n                        icon:\"success\",\r\n                    })\r\n                    setErr(\"\")\r\n                    IsVerified(true)\r\n                }\r\n                }).catch(function (error) {\r\n                // User couldn't sign in (bad verification code?)\r\n                // ...\r\n                swal({\r\n                    title:\"Not Verified\",\r\n                    text:\"Incorrect or Bad Verification Code\",\r\n                    icon: \"warning\"\r\n                }).then(res1=>{\r\n                    window.location.reload()\r\n                })\r\n                setErr(error.message+\" Reload and Try Again\")\r\n                });\r\n                            }).catch(function (error) {\r\n                            // Error; SMS not sent\r\n                            // ...\r\n                            swal({\r\n                                title:\"Some error Occured. Try Again Later!\",\r\n                                text:\"SMS not sent. Retry!\",\r\n                                icon: \"warning\",\r\n                                confirmButtonClass: \"btn-danger\",\r\n                                confirmButtonText: \"Retry\",   \r\n                            }).then(res1=>{\r\n                                window.location.reload()\r\n                            })\r\n                            setErr(error.message+\" Reload and Try Again\")\r\n                            });\r\n    }\r\n    async function handleResetPassword(e){\r\n        e.preventDefault();\r\n        var x=window.prompt(\"Enter your existing Email Id\")\r\n        if(x){\r\n            try{\r\n                var user=await auth.fetchSignInMethodsForEmail(x)\r\n                if(user.length===0){\r\n                    setErr('Please register! Your email is not registered or please enter the existing Email')\r\n                }\r\n                else{\r\n                    auth.sendPasswordResetEmail(x)\r\n                    setErr(\"Reset password link has been sent to your email!\")\r\n                }\r\n            }catch(err){\r\n                setErr(err.message)\r\n            }\r\n        }\r\n    }\r\n    async function handleLogin(e){\r\n        e.preventDefault()\r\n        try{\r\n            var username;\r\n            if(stud) username=\"StudentUsers\"\r\n            if(teach) username=\"TeacherUsers\"\r\n            dispatch(setUser(username))\r\n            await auth.signInWithEmailAndPassword(email,password)\r\n            var z=auth.currentUser\r\n            const userRef=firestore.doc(`${username}/${z.uid}`)\r\n            const snapShot=await userRef.get()\r\n            if(!snapShot.exists){\r\n                dispatch(setVerify(false))\r\n                setErr('You are trying to get login as different user (Student/Teacher)')\r\n                auth.signOut()\r\n                //window.location.reload()\r\n            }\r\n            else{\r\n                if(z.emailVerified){\r\n                    dispatch(setID(z.uid))\r\n                    history.push(\"/\")\r\n                    setErr(\"\")\r\n                    window.location.reload()\r\n                }\r\n                else{\r\n                    dispatch(setVerify(true))\r\n                    z.sendEmailVerification()\r\n                    setErr('Please Verify the mail and Log In!')\r\n                }\r\n            }\r\n        }catch(error){\r\n            setErr(error.message)\r\n            console.log(error.message)\r\n        }\r\n    }\r\n    async function handleRegister(e){\r\n        e.preventDefault()\r\n        if(!verify){\r\n            setErr(\"Please verify the PhoneNumber\")\r\n            return;\r\n        }\r\n        if(grade===''){\r\n            setErr('Please provide your Grade and then Register!')\r\n            return;\r\n        }\r\n        if(state===\"\"){\r\n            setErr(\"Please provide your State and then Register\")\r\n            return ;\r\n        }\r\n        try{\r\n            var username;\r\n            if(stud){\r\n                username=\"StudentUsers\";\r\n            }\r\n            if(teach){\r\n                username=\"TeacherUsers\";\r\n            }\r\n            const {user}=await auth.createUserWithEmailAndPassword(email,password)\r\n            var displayName=Fname+\" \"+Lname\r\n            displayName=displayName.toUpperCase()\r\n            createUserProfileDocument(user,username,{displayName,grade,phone,state,pin})\r\n            setLogin(true)\r\n            setSignup(false)\r\n            setErr('')\r\n        }catch(error){\r\n            setErr(error.message)\r\n            console.log(error.message)\r\n        }\r\n    }\r\n    \r\n    var data=[\"Andhra Pradesh\",\"Arunachal Pradesh\",\"Assam\",\"Bihar\",\"Chhattisgarh\",\"Goa\",\"Gujarat\",\"Haryana\",\"Himachal Pradesh\",\"Jharkhand\",\"Karnataka\",\"Kerala\",\"Madhya Pradesh\",\"Maharashtra\",\"Manipur\",\"Meghalaya\",\"Mizoram\",\"Nagaland\",\"Odisha\",\"Punjab\",\"Rajasthan\",\"Sikkim\",\"Tamil Nadu\",\"Telangana\",\"Tripura\",\"Uttar Pradesh\",\"Uttarakhand\",\"West Bengal\",\"Andaman and Nicobar\",\"Chandigarh\",\"Daman and Diu\",\"Dadar and Nagar Haveli\",\"Delhi\",\"Jammu and Kashmir\",\"Ladakh\",\"Lakshadweep\",\"Puducherry\"]\r\n    data.sort()\r\n    data=data.map(item => item.toUpperCase())\r\n      useEffect(() => {\r\n        showButton();\r\n        window.addEventListener('resize', showButton);\r\n      }, []);\r\n      var change=btn?\"34%\":\"38%\"\r\n    return (\r\n        <div className=\"initial\">\r\n            <div className=\"container\">\r\n                <section className=\"toggle-container\">\r\n                    <Button buttonStyle=\"btn--outline\" buttonSize={btn?\"btn-medium\":\"btn--wide\"} buttonColor={teach?\"green\":\"blue\"} onClick={handleToggle1}>Teacher</Button>\r\n                    <Button buttonStyle=\"btn--outline\" buttonSize={btn?\"btn-medium\":\"btn--wide\"} buttonColor={stud?\"green\":\"blue\"} onClick={handleToggle2}>Student</Button>\r\n                </section>\r\n                <section className=\"form-container\">\r\n                    <div className=\"toggle\">\r\n                        <button className={`signin ${color1}`} onClick={handleToggle3}>Sign In</button>\r\n                        <button className={`signin ${color2}`} onClick={handleToggle4}>Sign Up</button>\r\n                    </div>\r\n                    {\r\n                        login?(\r\n                            <>\r\n                                <p style={{color:\"green\",marginLeft:\"28%\",marginTop:\"5px\"}}>Login As a {stud?\"Student\":\"Teacher\"}</p>\r\n                            {\r\n                                currentVer?<p style={{color:\"green\",margin:\"7px\"}}>Please Verify Your Email And Log In Again (Link Has Been Sent)!</p>:null\r\n                            }\r\n                            {\r\n                                currentUser?<p style={{color:\"green\",marginLeft:\"35%\",marginTop:\"5px\"}}>You are Logged In!</p>:null\r\n                            }\r\n                            {\r\n                                err? <p style={{color:\"red\",margin:\"7px\"}}>{err}</p>: \"\"\r\n                            }\r\n                            <form onSubmit={handleLogin}>\r\n                                <FormInput type=\"text\" value={email} onChange={(e)=>setEmail(e.target.value)} placeholder=\"Email\" required />\r\n                                <FormInput type=\"password\" value={password} onChange={(e)=>setPassword(e.target.value)} placeholder=\"Password\" required />\r\n                               \r\n                                <span style={{marginLeft:change}}><Button type=\"submit\" buttonStyle=\"btn--primary\" buttonColor=\"green\" buttonSize={btn?\"btn--mobile\":\"btn--medium\"}>Login</Button></span>\r\n                            </form>\r\n                            <button className=\"reset\" onClick={handleResetPassword}>Reset Password</button>\r\n                                <span style={{marginLeft:\"44%\",fontWeight:\"bold\",color:\"black\"}}>Or</span>\r\n                                <button className=\"signinwithGoogle\" onClick={signInWithGoogle}>Sign In With Google</button>\r\n                            </>\r\n                        ):(\r\n                            <>\r\n                             <p style={{color:\"green\",marginLeft:\"28%\",marginTop:\"5px\"}}>Register As a {stud?\"Student\":\"Teacher\"}</p>\r\n                            {\r\n                                err? <p style={{color:\"red\",margin:\"7px\"}}>{err}</p>: \"\"\r\n                            }\r\n                            <form onSubmit={handleRegister}>\r\n                                <FormInput type=\"text\" value={Fname}  onChange={(e)=>setFname(e.target.value)} placeholder=\"First Name\" required />\r\n                                <FormInput type=\"text\" value={Lname} onChange={(e)=>setLname(e.target.value)} placeholder=\"Last Name\" required />\r\n                                <select className=\"select\" onChange={(e)=>setGrade(e.target.value)}>\r\n                                    <option value=\"\">Grade</option><option value=\"7\">7</option><option value=\"8\">8</option><option class=\"9\">9</option><option value=\"10\">10</option>\r\n                                </select>\r\n                                <FormInput type=\"email\" value={email} onChange={(e)=>setEmail(e.target.value)} placeholder=\"Email\" required />    \r\n                                {\r\n                                    verify?<FormInput type=\"phone\" value={phone} onChange={handlePhone} placeholder=\"Phone No.\" disabled required />:<FormInput type=\"phone\" value={phone} onChange={handlePhone} placeholder=\"Phone No.\" required />\r\n                                }\r\n                                {\r\n                                    verify?<p style={{marginLeft:\"18%\",color:\"green\"}}>PhoneNumber is Verified</p>:<Button point={disable} id=\"recaptcha\" buttonStyle=\"btn--primary\" buttonColor=\"blue\" buttonSize=\"btn--medium\" onClick={handleOTP}>Get OTP</Button>\r\n                                    \r\n                                }\r\n                                \r\n                                \r\n                                    <select className=\"select\" style={{backgroundColor: \"white\"}} onChange={(e)=>setState(e.target.value)}>\r\n                                        <option value=\"\">State/Union Territory</option> \r\n                                    {\r\n                                        data.map((item,i)=>{\r\n                                            return(\r\n                                                <option key={i} value={item}>{item}</option>\r\n                                            )\r\n                                        })\r\n                                    }    \r\n                                    </select>\r\n                               \r\n                                <FormInput type=\"number\"  value={pin} onChange={(e)=>Setpin(e.target.value)} placeholder=\"PIN Code\" required />\r\n                                <FormInput type=\"password\" value={password} onChange={(e)=>setPassword(e.target.value)} placeholder=\"Password\" required />\r\n                                <span style={{marginLeft:change}}><Button type=\"submit\" buttonStyle=\"btn--primary\" buttonColor=\"green\" buttonSize={btn?\"btn--mobile\":\"btn--medium\"}>Register</Button></span>\r\n                            </form>\r\n                            </>\r\n                        )\r\n                    }\r\n                </section>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst mapStateToProps=(state)=>({\r\n    currentUser: state.user.currentUser,\r\n    currentVer: state.userError.currentVer,\r\n    currentErr: state.userError.error\r\n})\r\n\r\nexport default withRouter(connect(mapStateToProps,null)(Signin))\r\n/*\r\n\r\n\r\n        var x= await fetch(\"http://127.0.0.1:8000/api/register/\",{\r\n            method: \"POST\",\r\n            body: JSON.stringify(data),\r\n            headers:{\r\n                'Content-type': 'application/json; charset=UTF-8',\r\n            },\r\n        }).then((res)=>{\r\n            if(res.ok){\r\n                console.log(res.json())\r\n            }\r\n            else{\r\n                res.json().then(err=>console.log(err.Error))\r\n            }\r\n        })\r\n\r\n\r\n\r\n        \r\n\r\n*/\r\n"]},"metadata":{},"sourceType":"module"}